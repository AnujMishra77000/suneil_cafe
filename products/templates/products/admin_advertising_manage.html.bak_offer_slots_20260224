{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advertising | Admin Dashboard</title>
    <style>
        body{margin:0;font-family:Arial,sans-serif;background:#f5f6f8;color:#1f2937}
        .wrap{max-width:1100px;margin:0 auto;padding:22px}
        .top{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
        .top h1{margin:0;color:#5a2e16}
        .btn{display:inline-block;text-decoration:none;padding:9px 12px;border-radius:8px;border:1px solid #d8dee6;background:#fff;color:#1f2937;font-weight:700;cursor:pointer}
        .btn-primary{background:#5a2e16;color:#fff;border-color:#5a2e16}
        .btn-danger{background:#b42318;color:#fff;border-color:#b42318}
        .layout{display:grid;grid-template-columns:380px 1fr;gap:14px;margin-top:14px}
        .card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:16px;box-shadow:0 8px 20px rgba(15,23,42,.08)}
        .ok{background:#ecfdf3;border:1px solid #abefc6;color:#067647;padding:10px;border-radius:10px;margin-bottom:12px}
        .field{display:flex;flex-direction:column;gap:6px;margin-bottom:10px}
        .field label{font-size:13px;font-weight:700;color:#334155}
        .field input{padding:9px 10px;border:1px solid #d8dee6;border-radius:8px;font-size:14px}
        .errors{color:#b42318;font-size:12px;line-height:1.35;margin-top:4px}
        .list{display:grid;grid-template-columns:1fr;gap:12px}
        .ad-item{border:1px solid #e6e9ee;border-radius:12px;overflow:hidden;background:#fff}
        .thumb{position:relative;height:180px;background:#111}
        .thumb img{width:100%;height:100%;object-fit:cover;display:block}
        .overlay{position:absolute;inset:0;background:linear-gradient(180deg, rgba(0,0,0,0.12), rgba(0,0,0,0.70));display:flex;flex-direction:column;justify-content:flex-end;padding:12px;color:#fff}
        .overlay h3{margin:0;font-size:19px}
        .overlay p{margin:4px 0 0;font-size:12px;opacity:.95}
        .meta{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;gap:8px;flex-wrap:wrap}
        .badge{font-size:11px;padding:4px 8px;border-radius:999px;font-weight:700}
        .active{background:#ecfdf3;color:#067647;border:1px solid #abefc6}
        .inactive{background:#fef3f2;color:#b42318;border:1px solid #fecdca}
        .actions{display:flex;gap:8px}
        .empty{color:#6b7280;font-size:13px}
        @media (max-width: 920px){.layout{grid-template-columns:1fr}}
    </style>
    <link rel="stylesheet" href="{% static 'notifications/notification_bell.css' %}?v=20260224-2" />
</head>
<body>
    <main class="wrap">
        <header class="top">
            <h1>Advertising Section</h1>
            <div>
                <a class="btn" href="/admin-dashboard/">Back to Dashboard</a>
            </div>
        </header>

        <section class="layout">
            <article class="card">
                <h2 style="margin:0 0 10px;color:#5a2e16">Add New Ad Card</h2>
                {% if created %}<div class="ok">Advertisement created successfully.</div>{% endif %}
                {% if updated %}<div class="ok">Advertisement updated successfully.</div>{% endif %}

                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="create" />

                    <div class="field">
                        <label for="id_title">Title</label>
                        {{ form.title }}
                        <div class="errors">{{ form.title.errors }}</div>
                    </div>

                    <div class="field">
                        <label for="id_subtitle">Subtitle</label>
                        {{ form.subtitle }}
                        <div class="errors">{{ form.subtitle.errors }}</div>
                    </div>

                    <div class="field">
                        <label for="id_image">Image</label>
                        {{ form.image }}
                        <div class="errors">{{ form.image.errors }}</div>
                    </div>

                    <div class="field">
                        <label for="id_cta_label">Button Text (Optional)</label>
                        {{ form.cta_label }}
                        <div class="errors">{{ form.cta_label.errors }}</div>
                    </div>

                    <div class="field">
                        <label for="id_cta_url">Button URL (Optional)</label>
                        {{ form.cta_url }}
                        <div class="errors">{{ form.cta_url.errors }}</div>
                    </div>

                    <div class="field">
                        <label for="id_display_order">Display Order</label>
                        {{ form.display_order }}
                        <div class="errors">{{ form.display_order.errors }}</div>
                    </div>

                    <div class="field">
                        <label for="id_is_active">Active</label>
                        {{ form.is_active }}
                        <div class="errors">{{ form.is_active.errors }}</div>
                    </div>

                    <button class="btn btn-primary" type="submit">Create Ad</button>
                </form>
            </article>

            <article class="card">
                <h2 style="margin:0 0 10px;color:#5a2e16">Current Ad Cards</h2>
                <div class="list">
                    {% for ad in ads %}
                    <div class="ad-item">
                        <div class="thumb">
                            <img src="{{ ad.image.url }}" alt="{{ ad.title }}" />
                            <div class="overlay">
                                <h3>{{ ad.title }}</h3>
                                {% if ad.subtitle %}<p>{{ ad.subtitle }}</p>{% endif %}
                            </div>
                        </div>
                        <div class="meta">
                            <div>
                                <span class="badge {% if ad.is_active %}active{% else %}inactive{% endif %}">{% if ad.is_active %}ACTIVE{% else %}INACTIVE{% endif %}</span>
                                <span style="font-size:12px;color:#6b7280">Order: {{ ad.display_order }}</span>
                            </div>
                            <div class="actions">
                                <form method="post" style="display:inline;">
                                    {% csrf_token %}
                                    <input type="hidden" name="action" value="toggle" />
                                    <input type="hidden" name="ad_id" value="{{ ad.id }}" />
                                    <button class="btn" type="submit">{% if ad.is_active %}Disable{% else %}Enable{% endif %}</button>
                                </form>
                                <form method="post" style="display:inline;" onsubmit="return confirm('Delete this ad card?');">
                                    {% csrf_token %}
                                    <input type="hidden" name="action" value="delete" />
                                    <input type="hidden" name="ad_id" value="{{ ad.id }}" />
                                    <button class="btn btn-danger" type="submit">Delete</button>
                                </form>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="empty">No advertisement cards yet.</div>
                    {% endfor %}
                </div>
            </article>
        </section>
    </main>
    <script src="{% static 'notifications/notification_bell.js' %}?v=20260224-2"></script>
    <script>
        if (window.ThathwamasiNotifications) {
            window.ThathwamasiNotifications.mount({ mode: "ADMIN" });
        }
    </script>
</body>
</html>
